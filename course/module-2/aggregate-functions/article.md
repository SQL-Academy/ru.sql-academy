---
meta:
    title: '–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏'
    description: '–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ SQL –∑–∞–ø—Ä–æ—Å–∞—Ö, —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –∏ –ø—Ä–∏–º–µ—Ä—ã'
---

# –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

–í —Å—Ç–∞—Ç—å–µ –æ–± –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞—Ö –º—ã –æ–±—Å—É–¥–∏–ª–∏, —á—Ç–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ `GROUP BY` –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.
–î–∞–≤–∞–π—Ç–µ –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ –Ω–∏—Ö –ø–æ–≥–ª—É–±–∂–µ üê≥.

> –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –Ω–∞–±–æ—Ä–µ –∑–Ω–∞—á–µ–Ω–∏–π –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

## –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ —Å –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π

```sql
SELECT [–ª–∏—Ç–µ—Ä–∞–ª—ã, –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ_—Ñ—É–Ω–∫—Ü–∏–∏, –ø–æ–ª—è_–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏]
FROM –∏–º—è_—Ç–∞–±–ª–∏—Ü—ã
GROUP BY –ø–æ–ª—è_–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏;
```

–ù–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–ø—Ä–æ—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ `AVG` –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

```sql
SELECT home_type, AVG(price) as avg_price FROM Rooms
GROUP BY home_type
```

| home_type       | avg_price |
| --------------- | --------- |
| Private room    | 89.4286   |
| Entire home/apt | 148.6667  |
| Shared room     | 40        |

## –û–ø–∏—Å–∞–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

| –§—É–Ω–∫—Ü–∏—è               | –û–ø–∏—Å–∞–Ω–∏–µ                         |
| :-------------------- | :------------------------------- |
| `SUM(–ø–æ–ª–µ_—Ç–∞–±–ª–∏—Ü—ã)`   | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É–º–º—É –∑–Ω–∞—á–µ–Ω–∏–π        |
| `AVG(–ø–æ–ª–µ_—Ç–∞–±–ª–∏—Ü—ã)`   | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ      |
| `COUNT(–ø–æ–ª–µ_—Ç–∞–±–ª–∏—Ü—ã)` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π    |
| `MIN(–ø–æ–ª–µ_—Ç–∞–±–ª–∏—Ü—ã)`   | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ  |
| `MAX(–ø–æ–ª–µ_—Ç–∞–±–ª–∏—Ü—ã)`   | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |

> –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π, –Ω–µ —Ä–∞–≤–Ω—ã—Ö `NULL`. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `COUNT(*)`.

## –ü—Ä–∏–º–µ—Ä—ã

<ERD databaseName="Airbnb" />

- –ù–∞–π–¥—ë–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ –≤–∏–¥–∞ –∂–∏–ª—å—è –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ —É–±—ã–≤–∞–Ω–∏—é:

  ```sql
  SELECT home_type, COUNT(*) as amount FROM Rooms
  GROUP BY home_type
  ORDER BY amount DESC
  ```

  | home_type       | amount |
  | --------------- | ------ |
  | Private room    | 28     |
  | Entire home/apt | 21     |
  | Shared room     | 1      |

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∂–∏–ª–æ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è –Ω–∞–π–¥—ë–º —Å–∞–º—É—é –ø–æ–∑–¥–Ω—é—é –¥–∞—Ç—É –≤—ã–µ–∑–¥–∞ (–ø–æ–ª–µ `end_date`)

  ```sql
  SELECT room_id, MAX(end_date) AS last_end_date FROM Reservations
  GROUP BY room_id
  ```

  | room_id | last_end_date        |
  | ------- | -------------------- |
  | 1       | 2019-02-04T12:00:00Z |
  | 2       | 2020-03-23T09:00:00Z |
  | 13      | 2020-04-21T10:00:00Z |
  | 16      | 2019-06-24T10:00:00Z |
  | 21      | 2020-02-29T10:00:00Z |
  | 19      | 2020-05-02T10:00:00Z |
  | 8       | 2020-01-21T12:00:00Z |
  | 7       | 2019-09-17T10:00:00Z |
  | 5       | 2020-05-15T10:00:00Z |
  | 50      | 2019-11-25T11:00:00Z |
  | 49      | 2020-06-11T10:00:00Z |
  | 48      | 2019-11-10T10:00:00Z |
  | 32      | 2020-01-18T13:00:00Z |
  | 17      | 2019-11-05T09:00:00Z |
  | 25      | 2020-04-22T09:00:00Z |
  | 14      | 2020-02-12T10:00:00Z |
  | 39      | 2019-12-09T10:00:00Z |
  | 38      | 2020-03-23T10:00:00Z |
